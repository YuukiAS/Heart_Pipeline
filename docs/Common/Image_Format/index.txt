3:I[4707,[],""]
4:I[6423,[],""]
5:I[8847,["501","static/chunks/c16f53c3-ce37603d8f693539.js","972","static/chunks/972-9470ce40926ab16d.js","59","static/chunks/59-9cd1dd4ccad2ec58.js","707","static/chunks/707-51fa5cff1d12b8ed.js","185","static/chunks/app/layout-68307c54ab787eab.js"],"Providers"]
6:I[6042,["501","static/chunks/c16f53c3-ce37603d8f693539.js","972","static/chunks/972-9470ce40926ab16d.js","59","static/chunks/59-9cd1dd4ccad2ec58.js","707","static/chunks/707-51fa5cff1d12b8ed.js","185","static/chunks/app/layout-68307c54ab787eab.js"],"Layout"]
7:I[2972,["972","static/chunks/972-9470ce40926ab16d.js","59","static/chunks/59-9cd1dd4ccad2ec58.js","321","static/chunks/app/docs/Common/Image_Format/page-9434aca8c7fafa06.js"],""]
0:["ZNNsFXdQLYaceZTupu_BE",[[["",{"children":["docs",{"children":["Common",{"children":["Image_Format",{"children":["__PAGE__",{}]}]}]}]},"$undefined","$undefined",true],["",{"children":["docs",{"children":["Common",{"children":["Image_Format",{"children":["__PAGE__",{},[["$L1","$L2",null],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","docs","children","Common","children","Image_Format","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","docs","children","Common","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","docs","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/Heart_Pipeline/_next/static/css/abe7650ef4b4478d.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","className":"h-full antialiased __variable_305501 __variable_0b6900","suppressHydrationWarning":true,"children":["$","body",null,{"className":"flex min-h-full bg-white dark:bg-slate-900","children":["$","$L5",null,{"children":["$","$L6",null,{"children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"className":"min-w-0 max-w-2xl flex-auto px-4 py-16 lg:max-w-none lg:pl-8 lg:pr-0 xl:px-16","children":["$","div",null,{"className":"flex h-full flex-col items-center justify-center text-center","children":[["$","p",null,{"className":"font-display text-sm font-medium text-slate-900 dark:text-white","children":"404"}],["$","h1",null,{"className":"mt-3 font-display text-3xl tracking-tight text-slate-900 dark:text-white","children":"Page not found"}],["$","p",null,{"className":"mt-2 text-sm text-slate-500 dark:text-slate-400","children":"Sorry, we couldn’t find the page you’re looking for."}],["$","$L7",null,{"href":"/","className":"mt-8 text-sm font-medium text-slate-900 dark:text-white","children":"Go back home"}]]}]}],"notFoundStyles":[]}]}]}]}]}]],null],null],["$L8",null]]]]
9:I[2414,["972","static/chunks/972-9470ce40926ab16d.js","59","static/chunks/59-9cd1dd4ccad2ec58.js","321","static/chunks/app/docs/Common/Image_Format/page-9434aca8c7fafa06.js"],"DocsHeader"]
a:I[3312,["972","static/chunks/972-9470ce40926ab16d.js","59","static/chunks/59-9cd1dd4ccad2ec58.js","321","static/chunks/app/docs/Common/Image_Format/page-9434aca8c7fafa06.js"],"PrevNextLinks"]
b:I[3362,["972","static/chunks/972-9470ce40926ab16d.js","59","static/chunks/59-9cd1dd4ccad2ec58.js","321","static/chunks/app/docs/Common/Image_Format/page-9434aca8c7fafa06.js"],"TableOfContents"]
2:[["$","div",null,{"className":"min-w-0 max-w-2xl flex-auto px-4 py-16 lg:max-w-none lg:pl-8 lg:pr-0 xl:px-16","children":[["$","article",null,{"children":[["$","$L9",null,{"title":"Medical Imaging Format and Computation Basics"}],["$","div",null,{"className":"prose prose-slate max-w-none dark:prose-invert dark:text-slate-400 prose-headings:scroll-mt-28 prose-headings:font-display prose-headings:font-normal lg:prose-headings:scroll-mt-[8.5rem] prose-lead:text-slate-500 dark:prose-lead:text-slate-400 prose-a:font-semibold dark:prose-a:text-sky-400 prose-a:no-underline prose-a:shadow-[inset_0_-2px_0_0_var(--tw-prose-background,#fff),inset_0_calc(-1*(var(--tw-prose-underline-size,4px)+2px))_0_0_var(--tw-prose-underline,theme(colors.sky.300))] hover:prose-a:[--tw-prose-underline-size:6px] dark:[--tw-prose-background:theme(colors.slate.900)] dark:prose-a:shadow-[inset_0_calc(-1*var(--tw-prose-underline-size,2px))_0_0_var(--tw-prose-underline,theme(colors.sky.800))] dark:hover:prose-a:[--tw-prose-underline-size:6px] prose-pre:rounded-xl prose-pre:bg-slate-900 prose-pre:shadow-lg dark:prose-pre:bg-slate-800/60 dark:prose-pre:shadow-none dark:prose-pre:ring-1 dark:prose-pre:ring-slate-300/10 dark:prose-hr:border-slate-800","children":[["$","h2",null,{"id":"dicom-files","children":"DICOM Files"}],["$","h3",null,{"id":"overview","children":"Overview"}],["$","p",null,{"children":"DICOM (Digital Imaging in Medicine) is the fundamental format of medical image datasets, storage and transfer. DICOM files contain headers that provide abundant information regarding the protocol, patient, and acquisition details."}],["$","p",null,{"children":["In python, ",["$","code",null,{"children":"pydicom"}]," can be used to work with DICOM files."]}],["$","p",null,{"children":"Most CMR data in UKBiobank are provided in DICOM format. However, each file only corresponds to a single time frame on a single slice and may be difficult to work with during segmentation/registration."}],["$","h2",null,{"id":"nif-ti-files","children":"NifTI Files"}],["$","h3",null,{"id":"overview-2","children":"Overview"}],["$","p",null,{"children":["NifTI (Neuroimaging Informatics Technology Initiative) is a standard format for neuroimaging data. NifTI files are stored in ",["$","code",null,{"children":".nii"}]," or ",["$","code",null,{"children":".nii.gz"}]," format."]}],["$","p",null,{"children":["In python, ",["$","code",null,{"children":"nibabel"}]," can be used to work with NifTI files."]}],["$","p",null,{"children":["In this pipeline, we convert the DICOM files to NifTI format for easier processing. The details can be found in ",["$","code",null,{"children":"script/prepare_data.py"}]," and ",["$","code",null,{"children":"utils/biobank_utils.py"}],"."]}],["$","h3",null,{"id":"header-and-affine-matrix","children":"Header and Affine Matrix"}],["$","p",null,{"children":["When working with NifTI files, we usually need to deal with two fields: ",["$","code",null,{"children":"affine"}]," and ",["$","code",null,{"children":"header"}],"."]}],["$","p",null,{"children":["The NifTI header contains a ",["$","code",null,{"children":"pixdim"}]," field, which is frequently used and describes the voxel size in each dimension. ",["$","strong",null,{"children":"It doesn't account for rotation and translation, but only provides the scale of the voxels"}],":"]}],["$","ul",null,{"children":[["$","li",null,{"children":[["$","code",null,{"children":"pixdim[1]"}]," is the voxel size in the x-direction, usually in millimeters"]}],["$","li",null,{"children":[["$","code",null,{"children":"pixdim[2]"}]," is the voxel size in the y-direction"]}],["$","li",null,{"children":[["$","code",null,{"children":"pixdim[3]"}]," is the voxel size in the z-direction"]}],["$","li",null,{"children":[["$","code",null,{"children":"pixdim[4]"}]," is the temporal resolution (if applicable), usually in seconds."]}]]}],["$","p",null,{"children":["The ",["$","code",null,{"children":"affine"}]," matrix, on the other hand, encapsulates ",["$","strong",null,{"children":"voxel size, rotation as well as translation"}],"."]}],["$","p",null,{"children":"The affine matrix takes the following form:"}],["$","p",null,{"children":["$$$"," ","\\text{Affine} ="," ","\\begin{bmatrix}"," ","s_x r_{11} & s_y r_{12} & s_z r_{13} & t_x \\"," ","s_x r_{21} & s_y r_{22} & s_z r_{23} & t_y \\"," ","s_x r_{31} & s_y r_{32} & s_z r_{33} & t_z \\"," ","0 & 0 & 0 & 1"," ","\\end{bmatrix}"," ","$$$"]}],["$","ul",null,{"children":[["$","li",null,{"children":"$$s_x, s_y, s_z$: Scaling factors that represent voxel sizes in $x,y,z$ directions"}],["$","li",null,{"children":"$$r_{ij}$: Direction cosines, indicating the rotation of the voxel grid relative to the physical space"}],["$","li",null,{"children":"$$t_x, t_y, t_z$: Translation factors, representing the origin of the image in physical space"}]]}],["$","p",null,{"children":"Therefore, $(s_xr_{11})^2+(s_xr_{21})^2+(s_xr_{31})^2=pixdim[1]$, both representing the voxel size in x dimension."}],["$","blockquote",null,{"children":["$","p",null,{"children":["Example1: The short axis file of patient 100240 at visit2, the affine matrix is"," ","$$\\text{Affine} = \\begin{bmatrix}"," ","-0.5549 & 1.4533 & -5.2436 & -140.9455 \\"," ","-1.4707 & 0.1463 & 5.8785 & 67.7619 \\"," ","-0.9310 & -1.0974 & -6.1602 & 259.3229 \\"," ","0 & 0 & 0 & 1"," ","\\end{bmatrix}$. The corresponding pixel dimension is $[-1.,  1.826923,  1.826923, 10.,  0.02462 ,  1.,  1.,  1.]$. Then the voxel size in x and y dimension is 1.826923mm. The slice gap + slice thickness is 100mm. The temporal resolution between time frames is 24.62ms."]}]}],["$","blockquote",null,{"children":["$","p",null,{"children":["Example2: The third column of the affine matrix represents the scaling and rotation in z direction, which is the ",["$","strong",null,{"children":"normal vector that aligns with the direction of stack of slices"}],". Since we need to center perpendicular to the septum in HLA to obtain SA view, the normalized vector ",["$","code",null,{"children":"long_axis = nim_sa.affine[:3, 2] / np.linalg.norm(nim_sa.affine[:3, 2])"}]," hence represents direction of long axis."]}]}],["$","blockquote",null,{"children":["$","p",null,{"children":["Example3: In the short axis we may have two set of landmarks on the same slice for the same time frame $(x_1, y_1)$ and $(x_2, y_2)$ that are used to determine the transverse diameter of the left ventricle. In this case we can multiply each landmark through ",["$","code",null,{"children":"np.dot(nim_sa.affine, np.array([x, y, 0, 1]))[:3]"}],". Then the diameter can be directly determined through ",["$","code",null,{"children":"np.linalg.norm"}],"..`"]}]}]]}]]}],["$","$La",null,{}]]}],["$","$Lb",null,{"tableOfContents":[{"level":2,"id":"dicom-files","title":"DICOM Files","children":[{"level":3,"id":"overview","title":"Overview"}]},{"level":2,"id":"nif-ti-files","title":"NifTI Files","children":[{"level":3,"id":"overview-2","title":"Overview"},{"level":3,"id":"header-and-affine-matrix","title":"Header and Affine Matrix"}]}]}]]
8:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"CacheAdvance - Never miss the cache again."}],["$","meta","3",{"name":"description","content":"Cache every single thing your app could ever do ahead of time, so your code never even has to run at all."}],["$","link","4",{"rel":"icon","href":"/Heart_Pipeline/favicon.ico","type":"image/x-icon","sizes":"16x16"}],["$","meta","5",{"name":"next-size-adjust"}]]
1:null
